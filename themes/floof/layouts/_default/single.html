{{ define "main" }}
{{ $section := .Section }}
{{ if or (eq $section "does") (eq $section "bucks") (eq $section "sold") (eq $section "wethers") (eq $section "for-sale") }}
{{/* Goat profile layout */}}
<div class="page-header">
  <h1>{{ .Title }}</h1>
  {{ with .Params.categories }}
  <div class="tag-list" style="justify-content: center; margin-top: 0.5rem;">
    {{ range . }}<span class="tag">{{ . }}</span>{{ end }}
  </div>
  {{ end }}
</div>
<div class="goat-profile">
  {{ .Content }}
  <p style="margin-top: 2rem;"><a href="{{ (printf "%s/" $section) | relURL }}">← Back to {{ $section | title }}</a></p>
</div>
<script>
(function(){
  var profile = document.querySelector('.goat-profile');
  if (!profile) return;
  var ps = profile.querySelectorAll('p');
  var group = [];
  function flush() {
    if (group.length < 1) return;
    var grid = document.createElement('div');
    grid.className = 'photo-grid';
    group[0].parentNode.insertBefore(grid, group[0]);
    group.forEach(function(p) { 
      var img = p.querySelector('img');
      grid.appendChild(img);
      p.remove();
    });
    group = [];
  }
  ps.forEach(function(p) {
    if (p.children.length === 1 && p.children[0].tagName === 'IMG' && p.textContent.trim() === '') {
      group.push(p);
    } else {
      flush();
    }
  });
  flush();
})();
</script>
{{ else }}
{{/* Blog/page layout */}}
<div class="single-content">
  <h1>{{ .Title }}</h1>
  {{ if .Date }}
  <div class="meta">
    {{ .Date.Format "January 2, 2006" }}
    {{ with .Params.categories }} · {{ range $i, $c := . }}{{ if $i }}, {{ end }}<a href="{{ (printf "categories/%s/" ($c | urlize)) | relURL }}">{{ $c }}</a>{{ end }}{{ end }}
  </div>
  {{ end }}
  {{ .Content }}
  {{ with .Params.tags }}
  <div class="tag-list" style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid var(--border);">
    {{ range . }}<a href="{{ (printf "tags/%s/" (. | urlize)) | relURL }}" class="tag">{{ . }}</a>{{ end }}
  </div>
  {{ end }}
</div>
{{ end }}
{{ end }}
